\chapter{Rigid Body Dynamics Simulation}

This chapter mainly introduces rigid body simulation to help you understand how computer simulate rigid dynamics based on traditional newton-euler equations. For more details, some contact forces solvers are decribed in this chapter. Afterwards, we will use one of solver to run some simulation and get the image data for the next step, grids-transfer. All the discussion about rigid simulation and contacts solver are based on 2-$D$ view.

\section{Rigid dynamics Simulation}

\subsection{Simulation Basics}

Simulating the motion of a rigid body is almost the same as simulating the motion of a particle, so I will start with partcle simulation. For particle simulation, we let function $x(t)$ describe the particle's location in world space at time $t$. Then we use $v(t)=\frac{\dif}{\dif(t)}x(t)$
to denote the velocity of the particle at time t. So, the state of a particle at a time t is the particle's position and velocity. We generalize this concept by defining a state vector $\textbf{Y}(t)$ for a system: for a single particle,
\begin{equation}
    \textbf{Y}(t) = \left(
        \begin{array}{c}
            x_{1}(t) \\
            v_{1}(t) \\
        \end{array}
    \right)
\end{equation}

For a system with $n$ particles, we enlarge $\textbf{Y}(t)$ to be
\begin{equation}
    \textbf{Y}(t) = \left(
    \begin{array}{c}
        x_{1}(t) \\
        v_{1}(t) \\
        ... \\
        x_{n}(t) \\
        v_{n}(t) \\
    \end{array}
    \right)
\end{equation}

However, to simulate the motion of particles actually, we need to know one more thing -- the forces. $F(t)$ is defined as the force acting on the particle. If the mass of the particle is $m$, then the changes of $\textbf{Y}(t)$ will be given by
\begin{equation}
    \frac{\dif}{\dif(t)}\textbf{Y}(t) = \frac{\dif}{\dif(t)}\left(
        \begin{array}{c}
            x(t) \\
            v(t) \\
        \end{array} \right) = \left(
        \begin{array}{c}
            v(t) \\
            F(t)/m \\
        \end{array} \right)
\end{equation}

\subsection{Rigid Body Concepts}
Unlike a particle, a rigid body occupies a volume of space and has a particular shape. Rigid bodies are more complicated, beside translating them, we can rotate them as well. To locate a rigid body, we use $x(t)$ to denote their translation and a rotation matrix $R(t)$ to describe their rotation.

\subsection{Rigid Body Equations of Motions}
Finally, we can covert all concepts we need to define the state $\textbf{Y}(t)$ for a rigid body.
\begin{equation}
    \textbf{Y}(t) = \left(
        \begin{array}{c}
            x(t) \\
            R(t) \\
            P(t) \\
            L(t) \\
        \end{array}
    \right)
\end{equation}
Like what is epressed in $\textbf{Y}(t)$, the state of a rigid body is mainly consist by its position and orientation (describing spatial information), and its linear and angualr momentum(describe velocity information). Since mass $M$ and bodyspace inertia tensor $I_{body}$ are constants, we can the auxiliary quantities $I(t)$, $\omega(t)$ at any given time.

\begin{equation}
    v(t) = \frac{P(t)}{M} \quad
    {I(t)} = R(t)I_{body}R(t)^{T} \quad
    \omega(t) = I(t)^{-1}L(t)
\end{equation}

The derivative $\frac{\dif}{\dif t}\textbf{Y}(t)$ is
\begin{equation}
    \frac{\dif}{\dif{t}}\textbf{Y}(t) = \frac{\dif}{\dif t}\left(
        \begin{array}{c}
            x(t) \\
            R(t) \\
            M v(t) \\
            L(t) \\
        \end{array}
    \right) = \frac{\dif}{\dif t}\left(
        \begin{array}{c}
            v(t) \\
            \omega(t)*R(t) \\
            F(t) \\
            \tau(t) \\
        \end{array}
    \right)
\end{equation}

Then, we can conclude the simulation algorithm

\begin{algorithm}[H]
 \KwData{this text}
 \KwResult{how to write algorithm with \LaTeX2e }
 initialization\;
 \While{running the simulation world}{
  read current\;
  \eIf{understand}{
   go to next section\;
   current section becomes this one\;
   }{
   go back to the beginning of current section\;
  }
 }
 \caption{How to write algorithms}
\end{algorithm}

\subsection{Twist/Wrench}
We will now introduce vectors called twists, which describe velocities, and wrenches, which describe forces, and explain how these objects transform from one coordinate frame to another one.
    \subsubsection{Twist}

    \subsubsection{Wrench}
        A wrench is a vector that expresses force and torque acting on a body. A wrench can be defined by 
            $$\mathbf{f} = \left( \begin{array}{c} \tau \\ f \\ \end{array} \right )$$ 

        A wrench contains an angular component $\tau$ and a linear component $f$, which are applied at the origin of the coordinate frame they are specified in.


\section{Constrained Dynamics}
    Most interesting simulations of rigid bodies involve some kind of constraints. Usually we want to model systems of bodies that are interacting in some way. Some bodies may be in contact with each other, or attached together by some types of joint. Since this report mainly research contact forces, we 
    \subsection{Expressing Constraints as Equations}
        We express constraints mathematically as algebraic matrix equations with position, velocity, or acceleration vectors as the unknowns. In general, the configuration space of a set of n rigid bodies has dimension 6n. Adding constraint equations restricts the position (or velocity, or acceleration) to a subspace of smaller dimension.\\

        The constraints discussed in this thesis will all be holonomic constraints, which means the constraint on the velocity can be found by taking the derivative of a position constraint. Constraints that do not fit this description are called nonholonomic. An example of a nonholonomic constraint is a ball rolling on a table without slipping. The position of the ball has five degrees of freedom, so there is only one degree of constraint (only the height is constrained). Taking the derivative of the position constraint would only give a velocity constraint of degree one. Additional constraints on the velocity are needed to prevent the ball from slipping.\\

        We will describe position constraints with a constraint function $g(\mathbf{p})$, which is a function from the space of possible positions of the rigid bodies, to R , where
    \subsection{contact Constraints}

\subsection{}